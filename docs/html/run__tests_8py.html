<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>MAGMA: /mnt/scratch/mgates/disable-v1/magma-2.0.2/testing/run_tests.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="magma-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MAGMA
   &#160;<span id="projectnumber">2.0.2</span>
   </div>
   <div id="projectbrief">Matrix Algebra for GPU and Multicore Architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('run__tests_8py.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">run_tests.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Mark Gates</dd></dl>
<p>Script to run testers with various matrix sizes.</p>
<p>See also the run_summarize.py script, which post-processes the output, sorting it into errors (segfaults, etc.), accuracy failures, and known failures. run_summarize.py can apply a different (larger) tolerance without re-running the tests.</p>
<p>Small sizes are chosen around block sizes (e.g., 30...34 around 32) to detect bugs that occur at the block size, and the switch over from LAPACK to MAGMA code. Tall and wide sizes are chosen to exercise different aspect ratios, e.g., nearly square, 2:1, 10:1, 1:2, 1:10. The -h or &ndash;help option provides a summary of the options.</p>
<h2>Non-interactive vs. interactive mode </h2>
<p>When output is redirected to a file, it runs in non-interactive mode, printing a short summary to stderr on the console and all other output to the file. For example: </p><pre class="fragment">  ./run_tests.py --lu --precision s --small &gt; lu.txt
  testing_sgesv_gpu -c                      ok
  testing_sgetrf_gpu -c2                    ok
  testing_sgetf2_gpu -c                     ok
  testing_sgetri_gpu -c                     ** 45 tests failed
  testing_sgetrf_mgpu -c2                   ok
  testing_sgesv -c                          ok
  testing_sgetrf -c2                        ok

  ****************************************************************************************************
  summary
  ****************************************************************************************************
    282 tests in 7 commands passed
     45 tests failed accuracy test
      0 errors detected (crashes, CUDA errors, etc.)
  routines with failures:
      testing_sgetri_gpu -c
</pre><p>When output is to console (tty), it runs in interactive mode, pausing after each test. At the pause, typing "M" re-makes and re-runs that tester, while typing enter goes to the next tester. For example (some output suppressed with ... for brevity): </p><pre class="fragment">  ./run_tests.py --lu --precision s --small
  ****************************************************************************************************
  ./testing_sgesv_gpu -c --range 1:20:1 ...
  ****************************************************************************************************
      N  NRHS   CPU Gflop/s (sec)   GPU Gflop/s (sec)   ||B - AX|| / N*||A||*||X||
  ================================================================================
      1     1     ---   (  ---  )      0.00 (   0.00)   9.26e-08   ok
      2     1     ---   (  ---  )      0.00 (   0.00)   1.32e-08   ok
      3     1     ---   (  ---  )      0.00 (   0.00)   8.99e-09   ok
  ...
    ok
  [enter to continue; M to make and re-run]

  ****************************************************************************************************
  ./testing_sgetri_gpu -c --range 1:20:1 ...
  ****************************************************************************************************
  % MAGMA 1.4.0 svn compiled for CUDA capability &gt;= 3.0
  % CUDA runtime 6000, driver 6000. MAGMA not compiled with OpenMP.
  % device 0: GeForce GT 750M, 925.5 MHz clock, 2047.6 MB memory, capability 3.0
  Usage: ./testing_sgetri_gpu [options] [-h|--help]

      N   CPU Gflop/s (sec)   GPU Gflop/s (sec)   ||R||_F / (N*||A||_F)
  =================================================================
      1      0.00 (   0.00)      0.00 (   0.00)   6.87e+01   failed
      2      0.00 (   0.00)      0.00 (   0.00)   2.41e+00   failed
      3      0.01 (   0.00)      0.00 (   0.00)   1.12e+00   failed
  ...
    ** 45 tests failed
  [enter to continue; M to make and re-run]

  ...

  ****************************************************************************************************
  summary
  ****************************************************************************************************
    282 tests in 7 commands passed
     45 tests failed accuracy test
      0 errors detected (crashes, CUDA errors, etc.)
  routines with failures:
      testing_sgetri_gpu -c
</pre><h2>What tests are run </h2>
<p>The &ndash;blas, &ndash;aux, &ndash;chol, &ndash;hesv, &ndash;lu, &ndash;qr, &ndash;syev, &ndash;sygv, &ndash;geev, &ndash;svd, &ndash;batched options run particular sets of tests. By default, all tests are run, except batched because we don't want to run batched with, say, N=1000. &ndash;mgpu runs only multi-GPU tests from the above sets. These may be negated with &ndash;no-blas, &ndash;no-aux, etc.</p>
<p>The &ndash;start option skips all testers before the given one, then continues with testers from there. This is helpful to restart a non-interactive set of tests. For example: </p><pre class="fragment">  ./run_tests.py --start testing_spotrf &gt; output.log
</pre><p>If specific testers are named on the command line, only those are run. For example: </p><pre class="fragment">  ./run_tests.py testing_spotrf testing_sgetrf
</pre><p>The -p/&ndash;precision option controls what precisions are tested, the default being "sdcz" for all four precisions. For example, to run single and double: </p><pre class="fragment">  ./run_tests.py -p sd
</pre><p>The -s/&ndash;small, -m/&ndash;medium, -l/&ndash;large options control what sizes are tested, the default being all three sets. -s/&ndash;small does small tests, N &lt; 300. -m/&ndash;medium does medium tests, N &lt; 1000. -l/&ndash;large does large tests, N &gt; 1000. For example, running small and medium tests: </p><pre class="fragment">  ./run_tests.py -s -m
</pre><p>Specific tests can be chosen using &ndash;itype, &ndash;version, -U/&ndash;upper, -L/&ndash;lower, -J/&ndash;jobz, -D/&ndash;diag, and &ndash;fraction. For instance: </p><pre class="fragment">   ./run_tests.py testing_ssygvdx_2stage -L -JN --itype 1 -s --no-mgpu
</pre><h2>What is checked </h2>
<p>The &ndash;memcheck option runs cuda-memcheck. This is very helpful for finding memory bugs (reading &amp; writing outside allocated memory). It is, however, slow.</p>
<p>The &ndash;tol option sets the tolerance to verify accuracy. This is 30 by default, which may be too tight for some testers. Setting it somewhat higher (e.g., 50 or 100) filters out spurious accuracy failures. Also see the run_summarize.py script, which parses the testers output and can filter out tests using a higher tolerance after the fact, without re-running them.</p>
<p>Run with default tolerance tol=30. </p><pre class="fragment">  ./run_tests.py -s -m testing_sgemv &gt; run-gemv.txt
  testing_sgemv -c                          ** 7 tests failed
  testing_sgemv -T -c                       ok
  testing_sgemv -C -c                       ok

  ****************************************************************************************************
  summary
  ****************************************************************************************************
    302 tests in 3 commands passed
      7 tests failed accuracy test
      0 errors detected (crashes, CUDA errors, etc.)
  routines with failures:
      testing_sgemv -c
</pre><p>Post-process with tolerance tol2=100. Numbers in {braces} are ratio = error/epsilon, which should be &lt; tol. Here, the ratio is just slightly larger {31.2 to 37.4} than the default tol=30. </p><pre class="fragment">  ./run_summarize.py --tol2 100 run-gemv.txt 
  single epsilon 5.96e-08,  tol2 100,  tol2*eps 5.96e-06,  30*eps 1.79e-06,  100*eps 5.96e-06,  1000*eps 5.96e-05
  double epsilon 1.11e-16,  tol2 100,  tol2*eps 1.11e-14,  30*eps 3.33e-15,  100*eps 1.11e-14,  1000*eps 1.11e-13
  ########################################################################################################################
  okay tests:                                          3 commands,    302 tests


  ########################################################################################################################
  errors (segfault, etc.):                             0 commands,      0 tests


  ########################################################################################################################
  failed tests (error &gt; tol2*eps):                     0 commands,      0 tests


  ########################################################################################################################
  suspicious tests (tol2*eps &gt; error &gt; tol*eps):       1 commands,      7 tests
  ./testing_sgemv
     63 10000      0.19 (   6.73)       1.65 (   0.76)      8.58 (   0.15)   1.86e-06 {   31.2}    1.11e-06 {   18.6}   suspect
     64 10000      0.19 (   6.73)       1.68 (   0.76)     14.36 (   0.09)   2.17e-06 {   36.4}    1.14e-06 {   19.1}   suspect
     65 10000      0.19 (   6.72)       1.43 (   0.91)      8.73 (   0.15)   2.23e-06 {   37.4}    1.09e-06 {   18.3}   suspect
     31 10000      0.09 (   6.70)       1.25 (   0.49)      6.33 (   0.10)   1.93e-06 {   32.4}    8.65e-07 {   14.5}   suspect
     32 10000      0.10 (   6.68)       1.35 (   0.47)     11.00 (   0.06)   2.15e-06 {   36.1}    9.14e-07 {   15.3}   suspect
     33 10000      0.10 (   6.72)       1.24 (   0.53)      9.85 (   0.07)   2.19e-06 {   36.7}    1.07e-06 {   18.0}   suspect
     10 10000      0.03 (   6.58)       0.52 (   0.39)      5.71 (   0.04)   2.23e-06 {   37.4}    1.11e-06 {   18.6}   suspect



  ########################################################################################################################
  known failures:                                      0 commands,      0 tests


  ########################################################################################################################
  ignored errors (e.g., malloc failed):                0 commands,      0 tests


  ########################################################################################################################
  other (lines that did not get matched):              0 commands,      0 tests
</pre><p>The &ndash;dev option sets which GPU device to use.</p>
<p>By default, a wide range of sizes and shapes (square, tall, wide) are tested, as applicable. The -N and &ndash;range options override these.</p>
<p>For multi-GPU codes, &ndash;ngpu specifies the number of GPUs, default 2. Most testers accept &ndash;ngpu -1 to test the multi-GPU code on a single GPU. (Using &ndash;ngpu 1 will usually invoke the single-GPU code.) </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_64f94c193e4d03baf6e89b1053934749.html">testing</a></li><li class="navelem"><a class="el" href="run__tests_8py.html">run_tests.py</a></li>
    <li class="footer">Generated on Mon May 2 2016 23:31:40 for MAGMA by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
